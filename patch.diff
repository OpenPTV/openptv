From 07e0ae0f14aa941134175ec051f37992e258df63 Mon Sep 17 00:00:00 2001
From: Alex Liberzon <alex.liberzon@gmail.com>
Date: Sun, 16 Feb 2014 20:52:42 +0200
Subject: [PATCH] WARNING: parameters.c is changed to provide backward
 compatibility this commit shall be pushed upstream

---
 liboptv/src/parameters.c | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/liboptv/src/parameters.c b/liboptv/src/parameters.c
index 4e5cfd6..0c61051 100644
--- a/liboptv/src/parameters.c
+++ b/liboptv/src/parameters.c
@@ -241,6 +241,12 @@ control_par* read_control_par(char *filename) {
         ret->cal_img_base_name[cam] = (char *) malloc(SEQ_FNAME_MAX_LEN);
         strncpy(ret->cal_img_base_name[cam], line, SEQ_FNAME_MAX_LEN);
     }
+    /* backward compatibility hack: Tcl/Tk version will look for 8 rows of strings */
+    for (cam = ret->num_cams; cam < 4; cam++){
+        if (fscanf(par_file, "%s\n", line) == 0) goto handle_error; 
+        if (fscanf(par_file, "%s\n", line) == 0) goto handle_error;
+    }
+    
     if(fscanf(par_file, "%d\n", &(ret->hp_flag)) == 0) goto handle_error;
     if(fscanf(par_file, "%d\n", &(ret->allCam_flag)) == 0) goto handle_error;
     if(fscanf(par_file, "%d\n", &(ret->tiff_flag)) == 0) goto handle_error;
-- 
1.8.4.2

